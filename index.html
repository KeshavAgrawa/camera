<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Device Motion Example</title>
<style>
    #motionInfo {
        font-size: 24px;
    }
</style>
</head>
<body>
<div id="motionInfo"></div>

<script>
var velocity = { x: 0, y: 0, z: 0 };
var position = { x: 0, y: 0, z: 0 };
var lastAcceleration = { x: 0, y: 0, z: 0 };
var lastVelocity = { x: 0, y: 0, z: 0 };
var lastTimestamp = null;

window.addEventListener('devicemotion', handleMotion);

function handleMotion(event) {
    var acceleration = event.accelerationIncludingGravity;
    var timestamp = event.timeStamp || Date.now(); // For some devices, event.timestamp is not available

    if (lastTimestamp) {
        var dt = (timestamp - lastTimestamp) / 1000; // Time interval in seconds

        // Trapezoidal rule for numerical integration
        velocity.x += 0.5 * (acceleration.x + lastAcceleration.x) * dt;
        velocity.y += 0.5 * (acceleration.y + lastAcceleration.y) * dt;
        velocity.z += 0.5 * (acceleration.z + lastAcceleration.z) * dt;

        position.x += 0.5 * (velocity.x + lastVelocity.x) * dt;
        position.y += 0.5 * (velocity.y + lastVelocity.y) * dt;
        position.z += 0.5 * (velocity.z + lastVelocity.z) * dt;
    }

    lastAcceleration.x = acceleration.x;
    lastAcceleration.y = acceleration.y;
    lastAcceleration.z = acceleration.z;

    lastVelocity.x = velocity.x;
    lastVelocity.y = velocity.y;
    lastVelocity.z = velocity.z;

    lastTimestamp = timestamp;

    // Calculate speed and direction
    var speed = Math.sqrt(velocity.x ** 2 + velocity.y ** 2 + velocity.z ** 2);
    var direction = Math.atan2(velocity.y, velocity.x);

    // Display speed and direction in the HTML element
    var motionInfoElement = document.getElementById('motionInfo');
    motionInfoElement.innerHTML = "Speed: " + speed.toFixed(2) + " m/s<br>" +
                                  "Direction: " + direction.toFixed(2) + " radians";
}
</script>
</body>
</html>
