<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Device Motion Example</title>
<style>
    #motionInfo {
        font-size: 24px;
    }
</style>
</head>
<body>
<div id="motionInfo"></div>

<script>
var velocity = { x: 0, y: 0, z: 0 };
var lastAcceleration = { x: 0, y: 0, z: 0 };
var lastTimestamp = null;
var motionStoppedThreshold = 0.1; // Threshold below which motion is considered stopped

window.addEventListener('devicemotion', handleMotion);

function handleMotion(event) {
    var acceleration = event.acceleration;
    var timestamp = event.timeStamp || Date.now(); // For some devices, event.timestamp is not available

    if (lastTimestamp) {
        var dt = (timestamp - lastTimestamp) / 1000; // Time interval in seconds

        // Integrate acceleration to obtain velocity for each axis
        velocity.x += acceleration.x * dt;
        velocity.y += acceleration.y * dt;
        velocity.z += acceleration.z * dt;
        
        // Reset velocity to zero if acceleration is close to zero
        if (Math.abs(acceleration.x) < motionStoppedThreshold &&
            Math.abs(acceleration.y) < motionStoppedThreshold &&
            Math.abs(acceleration.z) < motionStoppedThreshold) {
            velocity.x = 0;
            velocity.y = 0;
            velocity.z = 0;
        }
    }

    lastAcceleration.x = acceleration.x;
    lastAcceleration.y = acceleration.y;
    lastAcceleration.z = acceleration.z;

    lastTimestamp = timestamp;

    // Calculate speed for each axis
    var speedX = velocity.x;
    var speedY = velocity.y;
    var speedZ = velocity.z;

    // Display speed for each axis
    var motionInfoElement = document.getElementById('motionInfo');
    motionInfoElement.innerHTML = "Speed X: " + speedX.toFixed(2) + " m/s<br>" +
                                  "Speed Y: " + speedY.toFixed(2) + " m/s<br>" +
                                  "Speed Z: " + speedZ.toFixed(2) + " m/s";
}
</script>
</body>
</html>
